schema: '2.0'
stages:
  download:
    cmd: python3 src/download.py data prod.artie.rocks 27017 artie_u ArtieU123! artie
    deps:
    - path: src/download.py
      md5: 6a294a8efad9cb62af438e05070e4eb7
      size: 2325
    outs:
    - path: data/pedagogicalinterventions.json
      md5: fdf151397882da9a4ae189ebf84e860f
      size: 11665334
  transformation:
    cmd: python3 src/formatcsv.py data/pedagogicalinterventions.json data/pedagogicalinterventions.csv
    deps:
    - path: data/pedagogicalinterventions.json
      md5: fdf151397882da9a4ae189ebf84e860f
      size: 11665334
    - path: src/formatcsv.py
      md5: e95bddf76e345c06bd0f04370e32d265
      size: 9593
    outs:
    - path: data/pedagogicalinterventions.csv
      md5: a1ec3a12890e0e88df403d2a7ccb398f
      size: 1288587
  featureselection:
    cmd: python3 src/featureselection.py params.yaml data/pedagogicalinterventions.csv
      data/featureselection.csv data/selectedfeatures.csv
    deps:
    - path: data/pedagogicalinterventions.csv
      md5: a1ec3a12890e0e88df403d2a7ccb398f
      size: 1288587
    - path: src/featureselection.py
      md5: 75937019d6ecbc4b14aa030f9e09f338
      size: 3427
    params:
      params.yaml:
        selection.drop_columns:
        - exercise_is_evaluation
        - valid_solution
        - finished_exercise
        - exercise_valid_solution
        - student_motivation
        - grade
        - student_gender
        selection.high_correlation: 0.85
        selection.method: filter
        selection.number_of_features: 20
        selection.target: request_help
    outs:
    - path: data/featureselection.csv
      md5: 5b12bbf8af415abc82f6123f02e6cf7b
      size: 729267
    - path: data/selectedfeatures.csv
      md5: dc7c182442d30a4cef52c8aec7f3131e
      size: 387
    - path: dvc_plots/heatmap_correlation_after.png
      md5: 37098f5c3abeab4f2e6731229687e36b
      size: 246634
    - path: dvc_plots/heatmap_correlation_before.png
      md5: 46970e7b450d8a0c15d79bbfec6e5cb6
      size: 312546
  train:
    cmd: python3 src/train.py params.yaml data/featureselection.csv model/help_model.h5
      metrics/plots.csv metrics/scores.json
    deps:
    - path: data/featureselection.csv
      md5: 83a02a0d0bee7cecef62532749585212
      size: 752862
    - path: src/train.py
      md5: cb5e5cb3aebad8a67a6699d0bc2146fe
      size: 7011
    params:
      params.yaml:
        model.dropout_value: 0.5
        model.lstm_units: 256
        model.mask_value: -1
        model.percentage_train_size: 70
        model.return_sequences: true
        model.second_lstm_layer: true
        model.show_summary: true
        model.training_batch_size: 1
        model.training_epochs: 50
        model.use_dropouts: true
    outs:
    - path: images/model.png
      md5: ede8c57a8295da071aae260bbda3dd2e
      size: 51648
    - path: metrics/plots.csv
      md5: 0cfe7a792b882bcb3b252ab00abe869a
      size: 138
    - path: metrics/scores.json
      md5: c5923d8c7553a2564f5f4415952009c3
      size: 135
    - path: model/help_model.h5
      md5: 2f330d5eb81e32ab25d003c1b08605dc
      size: 9696232
  transformationdr:
    cmd: python3 src/formatcsv_datarobot.py data/pedagogicalinterventions.json data/pedagogicalinterventions_datarobot.csv
    deps:
    - path: data/pedagogicalinterventions.json
      md5: fdf151397882da9a4ae189ebf84e860f
      size: 11665334
    - path: src/formatcsv.py
      md5: e95bddf76e345c06bd0f04370e32d265
      size: 9593
    outs:
    - path: data/pedagogicalinterventions_datarobot.csv
      md5: 1b54b1dce67b5c5d48f9c6c36030c72b
      size: 2196270
